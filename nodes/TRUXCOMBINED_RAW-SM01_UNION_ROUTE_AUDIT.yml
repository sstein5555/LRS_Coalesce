steps:
  SM01_UNION_ROUTE_AUDIT-d56e4580-13ee-4929-b4c5-4aa24202b8c0:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: TRUXCOMBINED_RAW
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 413d99ae-218c-4ab3-8890-275ce5af9bab
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_ROUT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ec6450b4-b2df-45bd-8535-117089806f57
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: c8af28a4-f895-4ac2-b3b4-c61f7145eb9d
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 80656833-4f85-4b17-8a70-0aadc784d075
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: ba687272-4422-4f9a-94f3-0be99a7adcdf
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(18,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_SEQU
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e45973bf-bcb1-4e61-88d7-caa63b4a69b2
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: 2bfb5d46-7f7d-47d0-8b8b-2216fb1623f9
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_CUST
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 59e1e977-745c-4414-a49c-87a1dc61300c
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: d3f45a97-0db1-4e56-aeb7-00864ea164b9
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_SITE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f5bcad2c-89fc-4793-bb31-4bcadd9adf33
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: 0a89155f-f688-48d0-b110-4861c6e773a8
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_SERV
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 99268ac3-7290-487d-8f0f-48c07e7fd961
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: f49a93e2-bd3e-4dfd-9b9b-9e91081da07a
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(18,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_QTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bc721f0f-c8b4-48ee-9b51-a3806a609a5f
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: 03c3135c-24e5-4640-a1d5-03b9adef6ca0
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: VARCHAR(2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_ACTV
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e299131b-8106-49c5-a34d-a8c5d23ceb1f
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: ee4619b4-5c66-4deb-b3cf-c4447d7b008e
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(18,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_AMNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 924ec332-edc5-448d-90f6-f72b87c5a1d0
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: b1e00118-6287-4f1c-914e-c57eb11afc1b
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_IDTE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9f0d59ce-e53a-4e41-acd3-d1677cee4524
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: |-
                  CASE
                      WHEN "CM12_COMBINED"."CM12_STAGED"=0 THEN "SM01_COMBINED"."SM01_IDTE"
                      ELSE NULL
                  END
          - columnReference:
              columnCounter: cf61ff5d-28e9-4260-a13a-fd3e7e4ab485
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_WONU
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3158694d-1c1b-4292-ae31-b8cb433319c9
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: 91461fa2-c401-4ad5-9d7d-b53e2af8356c
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_CALLID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b3f385a1-216c-4cc6-b7c4-710cf1b174a3
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: 15d4fa86-306a-4eb8-90a9-5a9df8b344ad
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_STORIG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: de9da80d-7e39-45f5-93f5-efc2ee8e24fd
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: 88db1f0d-2649-49cf-9981-c6a4a9e5b7b1
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(18,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_PCHG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d30a2877-e9ec-4877-a06f-5c71ad110f13
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: IFNULL("SM01_COMBINED"."SM01_PCHG",0.00)
          - columnReference:
              columnCounter: fc96c965-9de5-4c14-b553-73f3445ab79b
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: NUMBER(18,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SM01_ORIG_SEQU
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6e9cd289-cd28-4a67-8b3d-c723b240c5ff
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
          - columnReference:
              columnCounter: fada5fe9-987e-4ed6-b842-276c321eadd4
              stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
            dataType: VARCHAR
            description: ""
            hashColumns: []
            hashDetails: null
            name: SOURCE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a1615b68-b197-45ac-807b-ed79b2be982a
                    stepCounter: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              CM12_COMBINED: 4f923860-b405-4745-ab70-88d5ff0d6d40
              SM01_COMBINED: 82475639-b6b5-4ad7-b9c0-98cffc711fcb
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: TRUXCOMBINED_RAW
                nodeName: CM12_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: SM01_COMBINED
            join:
              joinCondition: |-
                FROM {{ ref('TRUXCOMBINED_RAW', 'SM01_COMBINED') }} "SM01_COMBINED"
                LEFT JOIN {{ ref('TRUXCOMBINED_RAW', 'CM12_COMBINED') }} "CM12_COMBINED"
                ON "SM01_COMBINED"."SM01_ACTV" = "CM12_COMBINED"."CM12_CODE" and "SM01_COMBINED"."SOURCE" = "CM12_COMBINED"."SOURCE"
                WHERE "SM01_COMBINED"."_FIVETRAN_DELETED"=FALSE and "SM01_COMBINED"."Sort" = 1 and "SM01_COMBINED" ."METADATA$ACTION"='INSERT'
            name: SM01_UNION_ROUTE_AUDIT
            noLinkRefs: []
      name: SM01_UNION_ROUTE_AUDIT
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: d56e4580-13ee-4929-b4c5-4aa24202b8c0
