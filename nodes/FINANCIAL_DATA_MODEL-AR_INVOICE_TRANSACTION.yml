steps:
  AR_INVOICE_TRANSACTION-d498ce99-b60e-4c2c-ad6b-df38aad4cf45:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: false
      description: ""
      isMultisource: true
      locationName: FINANCIAL_DATA_MODEL
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 684a1a1b-4d9e-43da-bcfe-af0794d43d05
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Payment ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 12999707-1ce5-4bad-afff-4a8765d28654
                    stepCounter: b440fc4f-079f-4e49-96bf-221deac14011
                transform: ""
              - columnReferences: []
                transform: ""
              - columnReferences: []
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: ee92db5a-42f8-4b42-8331-566b85e9fbb1
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Invoice ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3c5e210c-c1a6-409a-a4a9-74f4a104ccc4
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 3c5e210c-c1a6-409a-a4a9-74f4a104ccc4
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: aabe0418-4d7f-4979-9f0b-20192ca175be
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 7baaf8b9-4904-4c94-97ae-67c1025d86ae
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Customer_Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c6879ef4-beac-426d-aa95-ec4058ddb673
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: c6879ef4-beac-426d-aa95-ec4058ddb673
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 24f2f555-dde9-4355-9055-7f49f44eaddd
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 748378fb-8fd3-4f62-9b43-ab2badf53830
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Site_Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5379cca1-7f0b-4e64-bbd8-c71aec741730
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 5379cca1-7f0b-4e64-bbd8-c71aec741730
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 29c80522-3280-4c09-87cf-63f6c2314a76
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 79ad6089-a71d-447e-837a-dd98b97a15c4
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: DB - Cust
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f799cde5-2702-492d-be83-b43e55baefd9
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: "\"AR_Invoice_Amounts\".\"SOURCE\"||\"AR_Invoice_Amounts\".\"Customer Number\""
              - columnReferences:
                  - columnCounter: f799cde5-2702-492d-be83-b43e55baefd9
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: "\"AR_Invoice_Amounts\".\"SOURCE\"||\"AR_Invoice_Amounts\".\"Customer Number\""
              - columnReferences:
                  - columnCounter: 24f2f555-dde9-4355-9055-7f49f44eaddd
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: "\"ARDETAIL_COMBINED\".\"COMPANYID\"||' - TOWER'||\"ARDETAIL_COMBINED\".\"CUSTID\""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4a15936e-ec30-48bc-8c04-7e20567a634c
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: DB - Site - Cust
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f799cde5-2702-492d-be83-b43e55baefd9
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: "\"AR_Invoice_Amounts\".\"SOURCE\"||\"AR_Invoice_Amounts\".\"Site Number\"||'-'||\"AR_Invoice_Amounts\".\"Customer Number\""
              - columnReferences:
                  - columnCounter: f799cde5-2702-492d-be83-b43e55baefd9
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: "\"AR_Invoice_Amounts\".\"SOURCE\"||\"AR_Invoice_Amounts\".\"Site Number\"||'-'||\"AR_Invoice_Amounts\".\"Customer Number\""
              - columnReferences:
                  - columnCounter: 24f2f555-dde9-4355-9055-7f49f44eaddd
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: "\"ARDETAIL_COMBINED\".\"COMPANYID\"||' - TOWER'||\"ARDETAIL_COMBINED\".\"SITEID\"||'-'||\"ARDETAIL_COMBINED\".\"CUSTID\""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 45d5c847-0b18-4b3a-bcb2-b9c6536091ce
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Invoice Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 581c44d4-daea-4fc9-a443-158eec519821
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 581c44d4-daea-4fc9-a443-158eec519821
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: ad251460-54b0-4b2c-a4a8-2ed433f20390
                    stepCounter: 926de0bb-edd5-4689-b171-81b4c6a87565
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4ac619a2-aebb-4ea0-9328-5fdbb78b22b2
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Transaction Type
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 89140966-dbd3-4e10-a71f-6e5110261a65
                    stepCounter: b440fc4f-079f-4e49-96bf-221deac14011
                transform: |-
                  CASE WHEN "AR_Payment_Details"."Payment or Adjustment" = 'P' THEN 'Payment'
                  WHEN "AR_Payment_Details"."Payment or Adjustment" = 'A' THEN 'Adjustment Payment'
                  else null END
              - columnReferences:
                  - columnCounter: 581c44d4-daea-4fc9-a443-158eec519821
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: |-
                  CASE WHEN CONTAINS("AR_Invoice_Amounts"."Invoice Number",'A')=TRUE THEN 'INVOICE ADJUSTMENT'
                  WHEN CONTAINS("AR_Invoice_Amounts"."Invoice Number",'A')=FALSE THEN 'Invoice'
                  ELSE NULL END
              - columnReferences: []
                transform: "'Open Balance'"
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: efd1fd71-e2e7-4210-b837-62eb84090934
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: TIMESTAMP_NTZ(9)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Transaction Date
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fbe18ab5-8dd8-49b6-a6aa-3d5af435c0be
                    stepCounter: b440fc4f-079f-4e49-96bf-221deac14011
                transform: ""
              - columnReferences:
                  - columnCounter: e6f56b2b-1b54-43c6-98e4-586d31c8653d
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 805cb634-6fcb-45ba-8537-755e1c5b7228
                    stepCounter: 926de0bb-edd5-4689-b171-81b4c6a87565
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 8e3c8097-35c7-448d-90b6-ea83c676d1d7
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: TIMESTAMP_NTZ(9)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Invoice Date
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e6f56b2b-1b54-43c6-98e4-586d31c8653d
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: e6f56b2b-1b54-43c6-98e4-586d31c8653d
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 805cb634-6fcb-45ba-8537-755e1c5b7228
                    stepCounter: 926de0bb-edd5-4689-b171-81b4c6a87565
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 1a84f6fc-2070-4bb9-8a72-91825a58071a
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: TIMESTAMP_NTZ(9)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Due Date
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6c02cb13-aac2-4697-8a30-eee9804bcb6b
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: COALESCE("AR_Invoice_Amounts"."Due Date","AR_Invoice_Amounts"."Invoice Date")
              - columnReferences:
                  - columnCounter: 6c02cb13-aac2-4697-8a30-eee9804bcb6b
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 805cb634-6fcb-45ba-8537-755e1c5b7228
                    stepCounter: 926de0bb-edd5-4689-b171-81b4c6a87565
                transform: coalesce("ARDETAIL_COMBINED"."DUEDATE","STG_INVOICE_COMBINED"."Invoice Date")
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b8099ac0-0cde-4b6c-bc26-3282b5177181
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: NUMBER(18,2)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Transaction Amount
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e1afa3ed-dc59-467b-9031-bb8e7b7e0c35
                    stepCounter: b440fc4f-079f-4e49-96bf-221deac14011
                transform: |-
                  CASE WHEN "AR_Payment_Details"."Payment or Adjustment" = 'P'
                  then "AR_Payment_Details"."Amount" * -1
                  WHEN "AR_Payment_Details"."Payment or Adjustment" = 'A'
                  THEN "AR_Payment_Details"."Amount"
                  ELSE NULL END
              - columnReferences:
                  - columnCounter: 5a271921-8496-4417-9c96-77c87aa5e397
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 0f1bd88d-c597-4606-a7fb-3e29f9bc9eee
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b847453c-f5f1-40c4-bd7b-7ca58199f049
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: NUMBER(18,2)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Invoice Amount
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5a271921-8496-4417-9c96-77c87aa5e397
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 5a271921-8496-4417-9c96-77c87aa5e397
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: fcd94242-4371-49f8-8cb6-51b727887267
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 69c2c92b-3a08-4f0e-9823-5eac751e61eb
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: NUMBER(18,2)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Balance
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "0"
              - columnReferences: []
                transform: "0"
              - columnReferences: []
                transform: "0"
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 383a96f1-e513-44d9-95b8-10d0baef026f
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: TIMESTAMP_NTZ(9)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Record Date
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 31ebb542-ad45-4b58-99c3-0fae0efb42fa
                    stepCounter: b440fc4f-079f-4e49-96bf-221deac14011
                transform: ""
              - columnReferences: []
                transform: ""
              - columnReferences: []
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: eec8d370-538a-4483-b5a9-0b1a2635ceae
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: GL Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0ccea02f-c6a7-436d-b305-89cfff25e8d1
                    stepCounter: b440fc4f-079f-4e49-96bf-221deac14011
                transform: ""
              - columnReferences: []
                transform: ""
              - columnReferences:
                  - columnCounter: 0cc61cf7-bc01-4726-bf31-d361b3743798
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: COALESCE("ARDETAIL_COMBINED"."CREDITACCT","ARDETAIL_COMBINED"."DEBITACCT")
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 23459ba2-0bca-4cfc-84e7-e9d0245a21cb
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Group ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 990e7222-72ba-46fe-9324-d7070b2c649d
                    stepCounter: b440fc4f-079f-4e49-96bf-221deac14011
                transform: ""
              - columnReferences: []
                transform: ""
              - columnReferences:
                  - columnCounter: 9dbd060f-29a4-4442-a6ad-c66763f6c05c
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 9dc214cd-b7f4-40ad-975c-dc77a5b66dc9
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: NUMBER(18,2)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: DSO_FROM_DUE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: |-
                  CASE WHEN "AR_Payment_Details"."Payment or Adjustment"='P'
                  THEN datediff(DAY,"AR_Invoice_Amounts"."Due Date","AR_Payment_Details"."Payment Date")
                  else NULL END
              - columnReferences: []
                transform: ""
              - columnReferences: []
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: fc28108a-eeb4-4bab-a656-42ba9b90f5aa
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: NUMBER(18,2)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: DSO_FROM_INVOICE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: CASE WHEN "AR_Payment_Details"."Payment or Adjustment" = 'P' THEN datediff(DAY,"AR_Invoice_Amounts"."Invoice Date","AR_Payment_Details"."Payment Date") else null END
              - columnReferences: []
                transform: ""
              - columnReferences: []
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6174c3cc-b1a6-4554-99e6-5676a8313638
              stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e8d9996c-bd50-44ab-9dd9-7851e4a95582
                    stepCounter: b440fc4f-079f-4e49-96bf-221deac14011
                transform: ""
              - columnReferences:
                  - columnCounter: e4337c49-1766-460d-ad3f-94fbcba823cc
                    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
                transform: ""
              - columnReferences:
                  - columnCounter: 9dbd060f-29a4-4442-a6ad-c66763f6c05c
                    stepCounter: dad57b1e-b8d9-4227-9d92-4f169f6ce074
                transform: "\"ARDETAIL_COMBINED\".\"COMPANYID\"||' - TOWER'"
            systemColumnType: None
            transform: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              AR_Invoice_Amounts: 6cbdcc75-9616-48ec-95e9-b79240d9b295
              AR_Payment_Details: b440fc4f-079f-4e49-96bf-221deac14011
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: FINANCIAL_DATA_MODEL
                nodeName: AR_Invoice_Amounts
              - locationName: FINANCIAL_DATA_MODEL
                nodeName: AR_Payment_Details
            join:
              joinCondition: |-
                FROM {{ ref('FINANCIAL_DATA_MODEL', 'AR_Payment_Details') }} "AR_Payment_Details"
                LEFT JOIN {{ ref('FINANCIAL_DATA_MODEL', 'AR_Invoice_Amounts') }} "AR_Invoice_Amounts"
                ON "AR_Payment_Details"."Link_Source" = "AR_Invoice_Amounts"."ID_Source"
                WHERE "AR_Payment_Details"."SOURCE" NOT LIKE '%TOWER%'
            name: TRUX_PAYMENTS
            noLinkRefs: []
          - aliases:
              AR_Invoice_Amounts: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: FINANCIAL_DATA_MODEL
                nodeName: AR_Invoice_Amounts
            join:
              joinCondition: |-
                FROM {{ ref('FINANCIAL_DATA_MODEL', 'AR_Invoice_Amounts') }} "AR_Invoice_Amounts"
                WHERE "SOURCE" NOT LIKE '%TOWER%'
            name: TRUX_INVOICES
            noLinkRefs: []
          - aliases:
              ARDETAIL_COMBINED: dad57b1e-b8d9-4227-9d92-4f169f6ce074
              STG_INVOICE_COMBINED: 926de0bb-edd5-4689-b171-81b4c6a87565
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: TOWER_COMBINED
                nodeName: ARDETAIL_COMBINED
              - locationName: TOWER_COMBINED
                nodeName: STG_INVOICE_COMBINED
            join:
              joinCondition: |-
                FROM {{ ref('TOWER_COMBINED', 'ARDETAIL_COMBINED') }} "ARDETAIL_COMBINED"
                LEFT JOIN {{ ref('TOWER_COMBINED', 'STG_INVOICE_COMBINED') }} "STG_INVOICE_COMBINED"
                ON "ARDETAIL_COMBINED"."INVOICEUID" = "STG_INVOICE_COMBINED"."Unique Invoice ID"
                WHERE "ARDETAIL_COMBINED"."BALANCE" <>0 and "ARDETAIL_COMBINED"."STATUS" = 2
            name: TOWER_OPEN_BALANCE
            noLinkRefs: []
      name: AR_INVOICE_TRANSACTION
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: d498ce99-b60e-4c2c-ad6b-df38aad4cf45
