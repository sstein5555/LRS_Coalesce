steps:
  SERVICEHISTORY_COMBINED_SEQUENCE-5055b40f-88d4-4395-afca-9a6f8536a937:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: TOWER_COMBINED
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 3ff9d579-bf4e-412f-a65d-c0ddf4bb506a
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SERVICEHISTORYUID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5d1d2d10-463a-4112-a822-c4662a654945
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: d2b8411b-3e50-4353-b96e-b6bd3ac9f962
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SERVICEHISTORYTYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c61949ea-3019-42c7-8236-de752fe5e054
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 85282c4a-aeeb-4733-96aa-4a5994a39142
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: WORKFLOWCODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 87a9a0a1-5634-4f56-bdfa-04cf2c2f5bd9
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 53ebe10c-06a2-41b1-a5f5-9087166869c8
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SERVICEQUEUE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2426fef9-3d5e-48b6-81f0-97554f0f213c
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 43a611b7-ceab-499c-8e0f-6c2c71f50ba6
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SOURCEUID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: aecc55c5-bafd-4dc4-8929-c5c76c491244
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 510aac1a-1007-43fd-a73e-929355b4afa0
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SERVICEORDERID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 964a065f-38a6-45fd-983d-dee2c63e0b32
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: f7afff36-319c-45d0-9653-cfd3ab14e3ca
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SERVICEINFOUID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0e743a67-030b-4050-a318-87d87809c45d
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 54c8c1e1-3ace-4474-b903-94a0a5fcabb4
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SERVICESCHEDULEUID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d331e7d8-0381-4abc-9147-926fbdd4642c
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 8144047d-309a-4bd1-ba1f-73456924a9e9
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: de5d629b-374d-4208-91b6-f2ad4e0e1c37
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 239478c0-ca59-4194-b2d0-f6b1f9532373
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: RELEASEDTOBILLING
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 009c3df6-0b17-49ea-a95e-0f4a67f189f5
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: ca91880e-69df-404f-8eae-536ac566ae2a
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: REASONNOTE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5da16833-8782-4372-aa58-3127e2413e89
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 9b72b8d8-9ffc-4f42-90dc-f66bbf5c3b6e
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Route
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: febcb50c-d2c3-4cc8-a955-7e2f9f09714c
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: cfa1af57-c59e-4e30-8270-80894c8a69f9
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,6)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Route Sequence
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9d18f1b1-a321-4694-a803-4dde75cd1901
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: f9bae9ee-b85b-43bf-b55e-cf80fe71e616
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Route Date
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bb099d91-0b01-42a0-8c04-00bbf95fa017
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: d2d0516a-4146-46cd-81f6-9766a72af76d
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Start Time
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6c8223e5-c142-4ef0-bd94-8330b97534f3
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: d42269ce-85e4-4196-bddc-d1efb53ca2d4
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Finish Time
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 055ea175-262a-4871-9045-904419f80c09
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 7e570fa0-f0b7-43b3-915a-409b5eeab77e
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SERVICENOTE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fb4f40a3-249f-4fb3-849a-9c467ab2f6ea
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 676e546b-acdb-4a56-936d-76f2bebb9ccf
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Work Order ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 93d68813-da5d-4147-866b-c3b58756c388
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: e5cc0b0f-16e1-40ed-8e34-4d300afa9966
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,6)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Lifts
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 78f2a8dd-f19c-4dd9-868a-4ea13e1cd577
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 1a9d6d27-1d00-4da6-9aa1-9d65679af82e
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,6)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Driver Total Cost
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 78993e75-1180-4595-a458-45e2b9c83037
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 0cff50b2-8cb4-4474-9d3c-9ac99a3f50eb
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Vehicle Total Cost
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 54d22e4b-647b-43c6-ad9b-a5d16f69b513
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 02ff824d-7e24-4f88-8961-3afeab748af1
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORIGINALSERVICEDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 47b3ac5c-5fdb-4d35-9917-f4c1df845d73
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 473df8e2-0bb5-4df3-bc78-ceddf3645f75
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,6)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LATITUDE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 767d4d8b-8320-4e30-a40b-043a5ba34ea7
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 3505eb34-9a3c-479b-b771-8edf04c7e6a2
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,6)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LONGITUDE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 27a199ac-7a40-4b74-bee4-fc1fbdb0eba7
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ""
          - columnReference:
              columnCounter: 02b2e0dd-8e45-4671-93d8-df449cd0d6c6
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Service Revenue
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ab42516a-9741-42e2-b6d7-6a4e7e1c0255
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ifnull("SERVICEHISTORY_COMBINED"."ALLOCATEDREVENUE",0)
          - columnReference:
              columnCounter: 763e966f-523e-440d-bb79-1c66488914a8
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Recurring Revenue Amount
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1e74ac8f-eea6-457c-ab11-5577a208412a
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ifnull("SERVICEHISTORY_COMBINED"."RECURRINGREVENUE",0)
          - columnReference:
              columnCounter: d705e840-25bd-48b0-b044-85fa50859559
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Surcharges
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a2ee1e21-023f-4026-bb02-d60d08bf3d41
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ifnull("SERVICEHISTORY_COMBINED"."SURCHARGES",0)
          - columnReference:
              columnCounter: 29169dd0-48d7-4103-a859-c57fc2ab14f4
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Work Order Revenue
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1abe1196-8290-40b2-b937-b4cc24960050
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ifnull("SERVICEHISTORY_COMBINED"."WORKORDERREVENUE",0)
          - columnReference:
              columnCounter: ac64eb61-0b37-42db-85a4-3f2e688301e4
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: THIRDPARTYSERVICECOST
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ea1c7fee-df3c-4f05-89e6-88f7d07224a1
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ifnull("SERVICEHISTORY_COMBINED"."THIRDPARTYSERVICECOST",0)
          - columnReference:
              columnCounter: b10ecd58-fe21-4ef2-a393-e403da7b94d5
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            dataType: NUMBER(38,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: THIRDPARTYWORKORDERCOST
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2f734154-0d74-44d8-be06-82e6c410a671
                    stepCounter: 8bf4908c-aeb8-48ae-95af-1e70bd990479
                transform: ifnull("SERVICEHISTORY_COMBINED"."THIRDPARTYWORKORDERCOST",0)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4f37aa7d-6b81-4c7b-ad1a-a4c26f93088a
              stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
            config: {}
            dataType: NUMBER(38,2)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Total Stop Time
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: TIMEDIFF(MINUTE,"SERVICEHISTORY_COMBINED"."STARTTIME","SERVICEHISTORY_COMBINED"."FINISHTIME")
            systemColumnType: None
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              SERVICEHISTORY_COMBINED: 8bf4908c-aeb8-48ae-95af-1e70bd990479
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: TOWER_COMBINED
                nodeName: SERVICEHISTORY_COMBINED
            join:
              joinCondition: FROM {{ ref('TOWER_COMBINED', 'SERVICEHISTORY_COMBINED') }} "SERVICEHISTORY_COMBINED"
            name: SERVICEHISTORY_COMBINED_SEQUENCE
            noLinkRefs: []
      name: SERVICEHISTORY_COMBINED_SEQUENCE
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 5055b40f-88d4-4395-afca-9a6f8536a937
